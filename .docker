#!/usr/bin/env zsh

dccmd() {
    echo "echoing args '${@:2}'"
    if [ -n $1 ] ; then
      case $1 in
        c | clean | prune)  docker system prune -a -f --volumes ;;
        sql)    sql ${@:2} ;;
        *)      docker compose $*   ;;
      esac
    else
      echo "dccmd '$1' is not a valid command"
    fi
}

sqlcmd() {
    if [ -n $1 ] ; then
      case $1 in
        start | up)                 dc -f .mssql up -d --quiet-pull     ;;
        stop | down | shutdown)     dc -f .mssql down --remove-orphans  ;;
        restart | reboot | refresh) dc -f .mssql restart                ;;
        *)  echo "sql '$1' cannot be executed via sqlcmd()" ;;
      esac
    else
      echo "sqlcmd '$1' is not a valid command"
    fi
}

# tierd of typing docker compose?
alias dc=dccmd

# dead simple sql server running on docker
# compose file is .mssql
# sql start: spin up sql server on default port.
# sql stop: shutdown sql server and remove container and image and everything.
# sql restart: attempt to restart the sql server.
alias sql=sqlcmd